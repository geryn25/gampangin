<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Detail Restoran</title>
        <link rel="stylesheet" href="style.css">
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <script type="text/javascript" src="js/jquery.js"></script>
        <script type="text/javascript" src="js/bootstrap.js"></script>   
    </head>
    <style>
    #box{
        width: 100%;
        height: 100%;
        border-radius: 40px;
        border-style: solid;
        border-color: #E74C3C;
        padding: 10%;
        margin-bottom: 10%;
    }
    p{
        text-align: center;
        font-size: 15px;
        color: grey;
    }
    h1{
        text-align: center;
        font-size: 20px;
    }
    h2{
        font-size: 15px;
        text-align: center;
    }
    h{
        text-align: center;
    }
    .jumlah{
        width: 30px;
    }
    #footer{
        height:50px;
        line-height:50px;
        background:#E74C3C;
        color:#fff;
        border-radius: 10px;
        position:fixed;
        width: 90%;
        bottom:10px;
        text-align: center;
    }
    button{
        background: none;
        text-align: center;
        border: none;
        color: blanchedalmond;
        font-size: 20px;
        width: 97.5%;
    }
    [hidden] {
        display: none
    }

    #loading {
        width: 350px;
    }   
    </style>
    <body>
        <form>
        <div class="container" style="padding: 5%; margin-bottom:10px; " >
            <div class="row" style="text-align: center; margin-left: 0%;">
                    <div class="">
                        <span class="col-sm-2">
                                <img src="back.png" style="width: 20px; height: 20px; text-align: right;">
                        </span>
                        <span class="col-sm-6">
                            <h style="font-size: 30px;"><b>Gampangin</b></h>
                        </span>
                        <span class="col-sm-4">
                                <img src="profilgampangin.png" style="width: 50px; height: 50px;">
                        </span>
                        <hr />
                    </div>
                    
            </div>
            <img id="loading" src="loading.gif" />
            <div id="toko" hidden></div>
            <hr />
            

            <div id="rss" hidden></div>
            <div id="footer" hidden>
                <!-- Tombol akan aktif jika value text field jumlah lebih dari 0 -->
                <!-- ketika di klik akan langsung direct ke konfirmasi_makanan -->
                <!-- <h1  style="text-align: center; margin-top: 10px;"><b>Pesan Sekarang</b></h1> -->
                <button><b>Pesan Sekarang</b></button>
            </div>
        </div>
        <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
        <script src="liff-starter.js"></script>
        <script>
         window.onload = function () {
    var url = document.location.href,
        params = url.split('?')[1].split('&'),
        data = {}, tmp;
    for (var i = 0, l = params.length; i < l; i++) {
         tmp = params[i].split('=');
         data[tmp[0]] = tmp[1];
    }
    var proxyUrl = 'https://floating-lake-80001.herokuapp.com/',
                targetUrl = 'https://delibot.000webhostapp.com/makanan?id_toko='+ data.id;
            fetch(proxyUrl + targetUrl)
                .then(response => response.json())
                .then(users => {
                    let output = '';
                    users.forEach(function (user) {

                        output += `
                            <div id="box">
                        <div class="row">
                    <div class="col-sm-4" style="text-align: center;">
                            <img width="100%" height="100%" src="udin.jpg" style=" border-radius: 10%;"/>
                    </div>
                    <div class="col-sm-8">
                        <h1><b>${user.nama_makanan}</b></h1>
                        <p style="text-align: center;">${user.deskripsi}</p>
                        <label style="color: green; text-align: center; margin-left: 25%;">Tersedia</label>
                        <label style="text-align: center;">Rp. ${user.harga}</label>
                        <div style="text-align: center;">
                            <span class="col-sm-4">
                                    <label style="color: green; ">Jumlah</label>
                            </span>
                             <span class="col-sm-4" style="text-align: center; " >
                                    <input class="jumlah" type="text" maxlength="2" onkeypress="return hanyaAngka(event)" value="0"/>
                             </span>
                             
                        </div>
                        <div style="text-align: center;">
                                <input type="text"  placeholder="catatan untuk penjual"/>
                        </div>
                    </div>
                </div>
            </div>
    
                        `;
                    });
                    document.getElementById("rss").innerHTML = output;
                    document.getElementById("rss").removeAttribute("hidden");
                });
    


    var proxyUrl = 'https://floating-lake-80001.herokuapp.com/',
                targetUrl = 'https://delibot.000webhostapp.com/mitra?id='+ data.id;
            fetch(proxyUrl + targetUrl)
                .then(response => response.json())
                .then(users => {
                    let output = '';
                    var tanggal = new Date();
                    var jam = tanggal.getHours() * 100;
                    var buka=''
                    users.forEach(function (user) {
                        if ((jam > parseInt(user.buka)) && (jam < parseInt(user.tutup))) {
                            buka='open.png'
                            document.getElementById("footer").removeAttribute("hidden");
                        } else {
                            buka = 'close.png'
                        }
                        output += `
                <div class="row">
                    <div class="">
                        <span class="col-sm-8">
                            <h style="font-size: 20px; text-align: center;"><b>${user.nama_mitra}</b></h>
                        </span>
                        <span class="col-sm-4" style="text-align: right;">
                            <img src="${buka}" style="width: 60px; height: 40px;">
                        </span>
                    </div>
                </div>
                <p style="text-align:left;">${user.alamat}</p>
                <h3 style="text-align: left; font-size: 15px;" ><b>${user.buka[0]}${user.buka[1]}.${user.buka[2]}${user.buka[3]} - ${user.tutup[0]}${user.tutup[1]}.${user.tutup[2]}${user.tutup[3]}</b></h2>
    
                        `;
                    });
                    document.getElementById("toko").innerHTML = output;
                    document.getElementById("toko").removeAttribute("hidden");
            document.getElementById("loading").remove();
                });
    
}
        </script>
        <script>
                function hanyaAngka(evt) {
                    var charCode = (evt.which) ? evt.which : event.keyCode
                        if (charCode > 31 && (charCode < 48 || charCode > 57))
             
                            return false;
                    return true;
                }
            </script>
        </form>
    </body>
</html>